{"ast":null,"code":"import _objectWithoutProperties from\"D:/\\u0422\\u0438\\u043C\\u043E\\u0444\\u0435\\u0439/\\u0420\\u0430\\u0431\\u043E\\u0442\\u0430/Go/Calendar/front_react/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";import _objectSpread from\"D:/\\u0422\\u0438\\u043C\\u043E\\u0444\\u0435\\u0439/\\u0420\\u0430\\u0431\\u043E\\u0442\\u0430/Go/Calendar/front_react/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";const _excluded=[\"id\"];import React,{useState,useEffect,useMemo,useCallback,useRef}from'react';import{Settings,Clock,Calendar,CheckCircle,Trash2,Home,List,ChevronDown,Loader,Zap,Bold,Italic,ListChecks,Palette,NotebookText,Users,MessageSquare}from'lucide-react';// --- FIREBASE IMPORTS ---\nimport{initializeApp}from'firebase/app';import{getAuth,signInAnonymously,signInWithCustomToken,onAuthStateChanged,setPersistence,browserLocalPersistence}from'firebase/auth';import{getFirestore,doc,getDoc,addDoc,setDoc,updateDoc,deleteDoc,onSnapshot,collection,query,where,orderBy,getDocs}from'firebase/firestore';// --- CONSTANTS ---\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const REMINDER_OPTIONS=[{label:'5 минут',value:5,unit:'minutes'},{label:'15 минут',value:15,unit:'minutes'},{label:'30 минут',value:30,unit:'minutes'},{label:'1 час',value:1,unit:'hour'},{label:'2 часа',value:2,unit:'hour'},{label:'1 день',value:1,unit:'day'},{label:'2 дня',value:2,unit:'day'}];const GeminiIcon=_ref=>{let{size=20,className=\"\"}=_ref;return/*#__PURE__*/_jsx(\"svg\",{className:className,width:size,height:size,viewBox:\"0 0 24 24\",fill:\"none\",xmlns:\"http://www.w3.org/2000/svg\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm1.6 15.6H10.4v-4.8H8.8V11.2h1.6V7.6h3.2v3.6h1.6v2.4h-1.6v4.8z\",fill:\"currentColor\"})});};// --- FIREBASE SETUP AND HOOKS ---\n// Глобальные переменные среды (обязательно для Canvas)\nconst appId=typeof __app_id!=='undefined'?__app_id:'default-app-id';const firebaseConfig=typeof __firebase_config!=='undefined'?JSON.parse(__firebase_config):{};const initialAuthToken=typeof __initial_auth_token!=='undefined'?__initial_auth_token:null;let app,db,auth;// Хук для инициализации Firebase и аутентификации\nconst useFirebaseInit=()=>{const[isAuthReady,setIsAuthReady]=useState(false);const[userId,setUserId]=useState(null);useEffect(()=>{try{// 1. Инициализация Firebase\napp=initializeApp(firebaseConfig);db=getFirestore(app);auth=getAuth(app);// Устанавливаем постоянное хранение, чтобы избежать повторной анонимной аутентификации\nsetPersistence(auth,browserLocalPersistence);// 2. Обработка Аутентификации\nconst authenticateUser=async()=>{if(initialAuthToken){await signInWithCustomToken(auth,initialAuthToken);}else{await signInAnonymously(auth);}};// 3. Установка слушателя изменений состояния аутентификации\nconst unsubscribe=onAuthStateChanged(auth,user=>{if(user){setUserId(user.uid);}else{// Если user null, это означает, что аутентификация еще не произошла\n// или пользователь вышел. В нашем случае, мы обеспечиваем вход выше.\nsetUserId(crypto.randomUUID());// Использование временного ID для анонимных\n}setIsAuthReady(true);});authenticateUser();return()=>unsubscribe();}catch(error){console.error(\"Ошибка инициализации Firebase или Аутентификации:\",error);setIsAuthReady(true);// Разрешаем UI продолжить, но без данных\n}},[]);return{isAuthReady,db,auth,userId};};// Хук для получения данных из Firestore в реальном времени\nconst useFirestore=(isAuthReady,userId)=>{const[items,setItems]=useState([]);const[isDataLoading,setIsDataLoading]=useState(true);useEffect(()=>{if(!isAuthReady||!db||!userId){// Ждем, пока аутентификация не будет готова и userId не будет установлен\nreturn;}// Путь к коллекции: artifacts/{appId}/users/{userId}/planner_items\nconst collectionPath=\"artifacts/\".concat(appId,\"/users/\").concat(userId,\"/planner_items\");const itemsCollectionRef=collection(db,collectionPath);// Получаем все записи и сортируем их локально\nconst unsubscribe=onSnapshot(itemsCollectionRef,snapshot=>{const fetchedItems=snapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));// Сортировка по lastEdited (самые новые заметки сверху)\nconst sortedItems=fetchedItems.sort((a,b)=>{const dateA=a.lastEdited?new Date(a.lastEdited).getTime():0;const dateB=b.lastEdited?new Date(b.lastEdited).getTime():0;return dateB-dateA;// Сортировка по убыванию\n});setItems(sortedItems);setIsDataLoading(false);},error=>{console.error(\"Ошибка подписки Firestore:\",error);setIsDataLoading(false);});return()=>unsubscribe();},[isAuthReady,userId]);return{items,isDataLoading};};// --- Вспомогательные функции ---\nconst generateUniqueId=()=>\"item_\".concat(Date.now(),\"_\").concat(Math.random().toString(36).substring(2,9));const useUrlParams=()=>{const[params,setParams]=useState({});useEffect(()=>{const searchParams=new URLSearchParams(window.location.search);const newParams={};for(const[key,value]of searchParams.entries()){newParams[key]=value;}setParams(newParams);},[]);return params;};// --- TMA HOOKS ---\nconst useTma=(mainButtonText,isMainButtonVisible,isMainButtonActive,onMainButtonClick)=>{var _window$Telegram;const[isTmaReady,setIsTmaReady]=useState(false);const tma=(_window$Telegram=window.Telegram)===null||_window$Telegram===void 0?void 0:_window$Telegram.WebApp;useEffect(()=>{if(tma){tma.ready();setIsTmaReady(true);if(!tma.isExpanded){tma.expand();}tma.MainButton.setText(mainButtonText);tma.MainButton.setParams({color:tma.themeParams.button_color});if(isMainButtonVisible){tma.MainButton.show();}else{tma.MainButton.hide();}if(isMainButtonActive){tma.MainButton.enable();}else{tma.MainButton.disable();}tma.onEvent('mainButtonClicked',onMainButtonClick);return()=>{tma.offEvent('mainButtonClicked',onMainButtonClick);};}else{console.warn(\"Telegram WebApp SDK не найден. Запуск в режиме разработки.\");setIsTmaReady(true);}},[tma,mainButtonText,isMainButtonVisible,isMainButtonActive,onMainButtonClick]);return{isTmaReady,tma};};// --- API Gemini (симуляция) ---\nconst simulateAIChat=(tma,item)=>{const title=item.title||\"Новая заметка\";tma===null||tma===void 0?void 0:tma.showAlert(\"\\u0421\\u0438\\u043C\\u0443\\u043B\\u044F\\u0446\\u0438\\u044F: \\u0417\\u0430\\u043F\\u0443\\u0449\\u0435\\u043D \\u0447\\u0430\\u0442 \\u0441 Gemini.\\n\\n\\u0422\\u0435\\u043C\\u0430: \\\"\".concat(title,\"\\\".\\n\\n\\u0417\\u0434\\u0435\\u0441\\u044C \\u043C\\u043E\\u0436\\u043D\\u043E \\u043F\\u043E\\u043F\\u0440\\u043E\\u0441\\u0438\\u0442\\u044C \\u0418\\u0418 \\u043F\\u043E\\u043C\\u043E\\u0447\\u044C \\u0441 \\u043A\\u043E\\u043D\\u0442\\u0435\\u043D\\u0442\\u043E\\u043C \\u0434\\u043B\\u044F \\u0437\\u0430\\u043C\\u0435\\u0442\\u043A\\u0438, \\u0430 \\u0437\\u0430\\u0442\\u0435\\u043C \\u0432\\u0441\\u0442\\u0430\\u0432\\u0438\\u0442\\u044C \\u0440\\u0435\\u0437\\u0443\\u043B\\u044C\\u0442\\u0430\\u0442 \\u0432 \\u0440\\u0435\\u0434\\u0430\\u043A\\u0442\\u043E\\u0440.\"),()=>{});};// --- Компонент \"Настройки\" ---\nconst SettingsView=_ref2=>{var _window$Telegram2,_window$Telegram2$Web,_window$Telegram2$Web2;let{tma,textColor,backgroundColor,hintColor,setCurrentPage,setAccentColor}=_ref2;if(tma)tma.setHeaderColor('secondary_bg_color');const geminiBlue='#4285F4';const currentAccentColor=((_window$Telegram2=window.Telegram)===null||_window$Telegram2===void 0?void 0:(_window$Telegram2$Web=_window$Telegram2.WebApp)===null||_window$Telegram2$Web===void 0?void 0:(_window$Telegram2$Web2=_window$Telegram2$Web.themeParams)===null||_window$Telegram2$Web2===void 0?void 0:_window$Telegram2$Web2.button_color)||'#007aff';return/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 space-y-6 min-h-screen\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"flex justify-between items-center mb-6\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold\",children:\"\\u041D\\u0430\\u0441\\u0442\\u0440\\u043E\\u0439\\u043A\\u0438\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentPage('calendar'),className:\"p-2 rounded-full transition-colors duration-200\",style:{backgroundColor:currentAccentColor,color:backgroundColor},children:/*#__PURE__*/_jsx(Home,{size:20})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 rounded-2xl shadow-xl space-y-3\",style:{backgroundColor:hintColor+'08'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",style:{color:textColor},children:[/*#__PURE__*/_jsx(Palette,{size:20}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-medium\",children:\"\\u0422\\u0435\\u043C\\u0430 \\u0438 \\u0426\\u0432\\u0435\\u0442\\u0430\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm\",style:{color:hintColor},children:\"\\u041F\\u0440\\u0438\\u043B\\u043E\\u0436\\u0435\\u043D\\u0438\\u0435 \\u0438\\u0441\\u043F\\u043E\\u043B\\u044C\\u0437\\u0443\\u0435\\u0442 \\u0446\\u0432\\u0435\\u0442\\u0430 \\u0432\\u0430\\u0448\\u0435\\u0439 \\u0442\\u0435\\u043C\\u044B Telegram (TMA) \\u0434\\u043B\\u044F \\u043C\\u0438\\u043D\\u0438\\u043C\\u0430\\u043B\\u0438\\u0437\\u043C\\u0430.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"pt-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-sm uppercase tracking-wider block mb-2\",style:{color:hintColor},children:\"\\u0412\\u044B\\u0431\\u0440\\u0430\\u0442\\u044C \\u0410\\u043A\\u0446\\u0435\\u043D\\u0442\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex space-x-3\",children:['#007aff','#34c759','#ff9500','#eb5757',geminiBlue].map(color=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>setAccentColor(color),className:\"w-10 h-10 rounded-full border-2 transition-transform duration-100 transform hover:scale-110\",style:{backgroundColor:color,borderColor:currentAccentColor===color?textColor:'transparent'},title:color},color))})]})]})]});};// --- Компонент \"Редактор\" ---\nconst EditorView=_ref3=>{let{itemData,setItemData,handleDelete,tma,backgroundColor,textColor,accentColor,hintColor,destructiveColor,simulateAIChat,navigateToSettings}=_ref3;const contentRef=useRef(null);const geminiBlue='#4285F4';if(tma)tma.setHeaderColor('secondary_bg_color');const handleChange=e=>{const{name,value,type,checked}=e.target;setItemData(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:type==='checkbox'?checked:value}));};// Хук для авто-изменения размера textarea\nuseEffect(()=>{if(contentRef.current){contentRef.current.style.height='auto';contentRef.current.style.height=\"\".concat(contentRef.current.scrollHeight,\"px\");}},[itemData.content,itemData.type]);const handleTypeChange=newType=>{setItemData(prev=>{let newData=_objectSpread(_objectSpread({},prev),{},{type:newType});// Логика по управлению датой/временем при смене типа\nif(newType==='Note'){newData.time='';newData.date='';newData.hasReminder=false;newData.reminderValue=15;newData.reminderUnit='minutes';}else if(newType==='Reminder'||newType==='Event'){newData.time=prev.time||'09:00';newData.date=prev.date||new Date().toISOString().split('T')[0];newData.hasReminder=prev.hasReminder!==undefined?prev.hasReminder:newType==='Reminder';}return newData;});};const handleReminderChange=e=>{const[value,unit]=e.target.value.split('_');setItemData(prev=>_objectSpread(_objectSpread({},prev),{},{reminderValue:parseInt(value,10),reminderUnit:unit}));};// Функция для вставки Markdown синтаксиса (симуляция)\nconst insertMarkdown=syntax=>{setItemData(prev=>{const currentContent=prev.content||'';const newContent=currentContent+syntax;return _objectSpread(_objectSpread({},prev),{},{content:newContent});});};const TypeButton=_ref4=>{let{type,icon:Icon,label}=_ref4;return/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleTypeChange(type),className:\"flex items-center justify-center p-3 rounded-xl transition-all duration-200 w-1/3 text-sm font-semibold \\n            \".concat(itemData.type===type?'bg-opacity-90':'bg-opacity-10 backdrop-blur-sm hover:bg-opacity-20',\"\\n          \"),style:{backgroundColor:itemData.type===type?accentColor:'transparent',color:itemData.type===type?backgroundColor:textColor,border:itemData.type!==type?\"1px solid \".concat(hintColor,\"33\"):'none'},children:[/*#__PURE__*/_jsx(Icon,{size:20,className:\"mr-2\"}),label]});};const needsDateTimeSection=itemData.type==='Event'||itemData.type==='Reminder';const showReminderCheckbox=itemData.type==='Event';const isNoteType=itemData.type==='Note';const isExistingItem=itemData.id&&itemData.id!=='new_item';// Стилизация выпадающего списка\nconst selectStyle={backgroundColor:hintColor+'15',color:textColor,border:'none',padding:'12px',borderRadius:'12px',appearance:'none',cursor:'pointer',backgroundImage:\"url(\\\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='%23\".concat(textColor.slice(1),\"'%3E%3Cpath d='M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z' clip-rule='evenodd' fill-rule='evenodd'%3E%3C/path%3E%3C/svg%3E\\\")\"),backgroundRepeat:'no-repeat',backgroundPosition:'right 0.7rem center',backgroundSize:'1.5em 1.5em'};// Функция для симуляции открытия модала совместного доступа\nconst handleShare=()=>{tma===null||tma===void 0?void 0:tma.showAlert('Симуляция: Открытие модала совместного доступа.\\n\\nЗдесь можно выбрать \"Ограниченный доступ\" или \"Доступ для редактирования\".');};return/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 space-y-4\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"flex justify-between items-center mb-6\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"text-2xl font-bold\",children:[itemData.id&&itemData.id!=='new_item'?'Редактировать':'Создать',\" \",isNoteType?'Заметку':itemData.type==='Event'?'Событие':'Напоминание']}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:navigateToSettings,className:\"p-2 rounded-full transition-colors duration-200\",style:{backgroundColor:accentColor,color:backgroundColor},children:/*#__PURE__*/_jsx(Settings,{size:20})}),isNoteType&&isExistingItem&&/*#__PURE__*/_jsx(\"button\",{onClick:handleShare,className:\"p-2 rounded-full transition-colors duration-200\",style:{backgroundColor:accentColor,color:backgroundColor},title:\"\\u041F\\u043E\\u0434\\u0435\\u043B\\u0438\\u0442\\u044C\\u0441\\u044F \\u0437\\u0430\\u043C\\u0435\\u0442\\u043A\\u043E\\u0439\",children:/*#__PURE__*/_jsx(Users,{size:20})}),isExistingItem&&/*#__PURE__*/_jsx(\"button\",{onClick:handleDelete,className:\"p-2 rounded-full transition-colors duration-200\",style:{backgroundColor:destructiveColor,color:backgroundColor},title:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u0437\\u0430\\u043F\\u0438\\u0441\\u044C\",children:/*#__PURE__*/_jsx(Trash2,{size:20})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 rounded-2xl shadow-xl\",style:{backgroundColor:hintColor+'08'},children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-xs uppercase tracking-wider block mb-2\",style:{color:hintColor},children:\"\\u0422\\u0438\\u043F \\u0437\\u0430\\u043F\\u0438\\u0441\\u0438\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsx(TypeButton,{type:\"Event\",icon:Calendar,label:\"\\u0421\\u043E\\u0431\\u044B\\u0442\\u0438\\u0435\"}),/*#__PURE__*/_jsx(TypeButton,{type:\"Reminder\",icon:Clock,label:\"\\u041D\\u0430\\u043F\\u043E\\u043C\\u0438\\u043D\\u0430\\u043D\\u0438\\u0435\"}),/*#__PURE__*/_jsx(TypeButton,{type:\"Note\",icon:CheckCircle,label:\"\\u0417\\u0430\\u043C\\u0435\\u0442\\u043A\\u0430\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 rounded-2xl shadow-xl\",style:{backgroundColor:hintColor+'08'},children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-xs uppercase tracking-wider block mb-2\",style:{color:hintColor},htmlFor:\"title\",children:\"\\u0417\\u0430\\u0433\\u043E\\u043B\\u043E\\u0432\\u043E\\u043A\"}),/*#__PURE__*/_jsx(\"input\",{id:\"title\",name:\"title\",type:\"text\",value:itemData.title,onChange:handleChange,className:\"w-full text-lg bg-transparent border-none focus:outline-none placeholder-gray-500\",style:{color:textColor},placeholder:\"\\u041A\\u0440\\u0430\\u0442\\u043A\\u043E\\u0435 \\u043D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 rounded-2xl shadow-xl\",style:{backgroundColor:hintColor+'08'},children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-xs uppercase tracking-wider block mb-2\",style:{color:hintColor},htmlFor:\"content\",children:\"\\u041E\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u0435 / \\u041A\\u043E\\u043D\\u0442\\u0435\\u043D\\u0442\"}),isNoteType&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2 mb-2 p-1 rounded-lg\",style:{backgroundColor:hintColor+'11'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>insertMarkdown('**Жирный текст**'),className:\"p-2 rounded-lg hover:opacity-80 transition-opacity\",style:{color:textColor},title:\"\\u0416\\u0438\\u0440\\u043D\\u044B\\u0439 \\u0448\\u0440\\u0438\\u0444\\u0442\",children:/*#__PURE__*/_jsx(Bold,{size:18})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>insertMarkdown('*Курсив*'),className:\"p-2 rounded-lg hover:opacity-80 transition-opacity\",style:{color:textColor},title:\"\\u041A\\u0443\\u0440\\u0441\\u0438\\u0432\",children:/*#__PURE__*/_jsx(Italic,{size:18})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>insertMarkdown('\\n- [ ] Задача'),className:\"p-2 rounded-lg hover:opacity-80 transition-opacity\",style:{color:textColor},title:\"\\u0421\\u043F\\u0438\\u0441\\u043E\\u043A \\u0437\\u0430\\u0434\\u0430\\u0447\",children:/*#__PURE__*/_jsx(ListChecks,{size:18})})]}),/*#__PURE__*/_jsx(\"textarea\",{ref:contentRef,id:\"content\",name:\"content\",value:itemData.content,onChange:handleChange,rows:\"1\",className:\"w-full text-base bg-transparent border-none focus:outline-none placeholder-gray-500 resize-none overflow-hidden\",style:{color:textColor},placeholder:\"\\u041F\\u043E\\u0434\\u0440\\u043E\\u0431\\u043D\\u043E\\u0441\\u0442\\u0438, \\u043C\\u0435\\u0441\\u0442\\u043E, \\u0443\\u0447\\u0430\\u0441\\u0442\\u043D\\u0438\\u043A\\u0438...\"})]}),isNoteType&&/*#__PURE__*/_jsxs(\"button\",{onClick:()=>simulateAIChat(tma,itemData),className:\"w-full flex items-center justify-center p-3 rounded-xl text-sm font-bold transition-opacity duration-200 hover:opacity-90\",style:{backgroundColor:geminiBlue,color:'white'},children:[/*#__PURE__*/_jsx(MessageSquare,{size:20,className:\"mr-2\",style:{color:'white'}}),\"\\u041E\\u0442\\u043A\\u0440\\u044B\\u0442\\u044C \\u0447\\u0430\\u0442 \\u0441 Gemini\"]}),needsDateTimeSection&&/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 rounded-2xl shadow-xl\",style:{backgroundColor:hintColor+'08'},children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-xs uppercase tracking-wider block mb-2\",style:{color:hintColor},htmlFor:\"date\",children:\"\\u0414\\u0430\\u0442\\u0430\"}),/*#__PURE__*/_jsx(\"input\",{id:\"date\",name:\"date\",type:\"date\",value:itemData.date,onChange:handleChange,className:\"w-full text-lg bg-transparent border-none focus:outline-none\",style:{color:textColor}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 rounded-2xl shadow-xl\",style:{backgroundColor:hintColor+'08'},children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-xs uppercase tracking-wider block mb-2\",style:{color:hintColor},htmlFor:\"time\",children:\"\\u0412\\u0440\\u0435\\u043C\\u044F\"}),/*#__PURE__*/_jsx(\"input\",{id:\"time\",name:\"time\",type:\"time\",value:itemData.time,onChange:handleChange,className:\"w-full text-lg bg-transparent border-none focus:outline-none\",style:{color:textColor}})]})]}),isNoteType&&isExistingItem&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 rounded-2xl shadow-xl\",style:{backgroundColor:hintColor+'08'},children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-xs uppercase tracking-wider block mb-2\",style:{color:hintColor},children:\"\\u0414\\u0430\\u0442\\u0430 \\u043F\\u043E\\u0441\\u043B\\u0435\\u0434\\u043D\\u0435\\u0433\\u043E \\u0440\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u044F\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-base\",style:{color:textColor},children:new Date(itemData.lastEdited).toLocaleString('ru-RU')})]}),needsDateTimeSection&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 rounded-2xl shadow-xl space-y-4\",style:{backgroundColor:hintColor+'08'},children:[showReminderCheckbox?/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-lg\",style:{color:textColor},children:\"\\u041D\\u0430\\u043F\\u043E\\u043C\\u043D\\u0438\\u0442\\u044C\"}),/*#__PURE__*/_jsx(\"div\",{className:\"h-6 w-6 rounded-lg flex items-center justify-center transition-all duration-200 cursor-pointer\",style:{backgroundColor:itemData.hasReminder?accentColor:hintColor+'33',border:itemData.hasReminder?'none':\"1px solid \".concat(hintColor)},onClick:()=>setItemData(prev=>_objectSpread(_objectSpread({},prev),{},{hasReminder:!prev.hasReminder})),children:itemData.hasReminder&&/*#__PURE__*/_jsx(CheckCircle,{size:16,style:{color:backgroundColor}})})]}):/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium\",style:{color:textColor},children:\"\\u041D\\u0430\\u0441\\u0442\\u0440\\u043E\\u0439\\u043A\\u0438 \\u041D\\u0430\\u043F\\u043E\\u043C\\u0438\\u043D\\u0430\\u043D\\u0438\\u044F\"}),(itemData.hasReminder||itemData.type==='Reminder')&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-xs uppercase tracking-wider block mb-2\",style:{color:hintColor},htmlFor:\"reminderSelect\",children:\"\\u041D\\u0430\\u043F\\u043E\\u043C\\u043D\\u0438\\u0442\\u044C \\u0437\\u0430...\"}),/*#__PURE__*/_jsx(\"select\",{id:\"reminderSelect\",value:\"\".concat(itemData.reminderValue,\"_\").concat(itemData.reminderUnit),onChange:handleReminderChange,style:selectStyle,children:REMINDER_OPTIONS.map(opt=>/*#__PURE__*/_jsx(\"option\",{value:\"\".concat(opt.value,\"_\").concat(opt.unit),style:{backgroundColor:backgroundColor,color:textColor},children:opt.label},\"\".concat(opt.value,\"_\").concat(opt.unit)))})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"h-20\"})]});};// --- Компонент \"Календарь\" ---\nconst CalendarView=_ref5=>{let{tma,items,textColor,accentColor,hintColor,navigateToEditor,navigateToSettings}=_ref5;if(tma)tma.setHeaderColor('secondary_bg_color');// Фильтруем все, что не является Note, и группируем по дате\nconst scheduledItems=items.filter(item=>item.type==='Event'||item.type==='Reminder');const groupedItems=scheduledItems.reduce((acc,item)=>{const date=item.date;if(!acc[date]){acc[date]=[];}acc[date].push(item);return acc;},{});const sortedDates=Object.keys(groupedItems).sort((a,b)=>new Date(a)-new Date(b));const getIcon=type=>{switch(type){case'Event':return/*#__PURE__*/_jsx(Calendar,{size:18,style:{color:accentColor}});case'Reminder':return/*#__PURE__*/_jsx(Clock,{size:18,style:{color:accentColor}});default:return null;}};return/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 space-y-6 min-h-screen\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"flex justify-between items-center mb-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold\",style:{color:textColor},children:\"\\u041A\\u0430\\u043B\\u0435\\u043D\\u0434\\u0430\\u0440\\u044C\"}),/*#__PURE__*/_jsx(\"button\",{onClick:navigateToSettings,className:\"p-2 rounded-full transition-colors duration-200\",style:{backgroundColor:accentColor,color:'white'},children:/*#__PURE__*/_jsx(Settings,{size:20})})]}),sortedDates.length===0&&/*#__PURE__*/_jsx(\"p\",{style:{color:hintColor},children:\"\\u0423 \\u0432\\u0430\\u0441 \\u043F\\u043E\\u043A\\u0430 \\u043D\\u0435\\u0442 \\u0437\\u0430\\u043F\\u043B\\u0430\\u043D\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u043D\\u044B\\u0445 \\u0441\\u043E\\u0431\\u044B\\u0442\\u0438\\u0439 \\u0438\\u043B\\u0438 \\u043D\\u0430\\u043F\\u043E\\u043C\\u0438\\u043D\\u0430\\u043D\\u0438\\u0439.\"}),sortedDates.map(date=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm uppercase font-semibold mb-2\",style:{color:hintColor},children:new Date(date).toLocaleDateString('ru-RU',{weekday:'long',year:'numeric',month:'long',day:'numeric'})}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:groupedItems[date].sort((a,b)=>(a.time||'00:00').localeCompare(b.time||'00:00')).map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center p-3 rounded-xl cursor-pointer transition-all duration-200 hover:opacity-80\",style:{backgroundColor:hintColor+'08'},onClick:()=>navigateToEditor(item.id),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[getIcon(item.type),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium\",style:{color:textColor},children:item.title}),(item.type==='Event'||item.type==='Reminder')&&item.time&&/*#__PURE__*/_jsx(\"p\",{className:\"text-xs\",style:{color:hintColor},children:item.time}),item.hasReminder&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs font-semibold\",style:{color:accentColor},children:[\"\\u041D\\u0430\\u043F\\u043E\\u043C\\u043D\\u0438\\u0442\\u044C \\u0437\\u0430 \",item.reminderValue,\" \",item.reminderUnit==='minutes'?'мин.':item.reminderUnit==='hour'?'ч.':'д.']})]})]}),/*#__PURE__*/_jsx(ChevronDown,{size:16,style:{color:hintColor},className:\"rotate-[-90deg]\"})]},item.id))})]},date))]});};// --- Компонент \"Мои Заметки\" ---\nconst NotesView=_ref6=>{let{items,textColor,accentColor,hintColor,navigateToEditor,tma,navigateToSettings}=_ref6;if(tma)tma.setHeaderColor('secondary_bg_color');// Фильтруем и сортируем заметки по дате редактирования (сортировка уже сделана в useFirestore)\nconst notes=items.filter(item=>item.type==='Note');const formatDateTime=dateTimeString=>{if(!dateTimeString)return'Нет данных';try{const date=new Date(dateTimeString);return date.toLocaleDateString('ru-RU')+' '+date.toLocaleTimeString('ru-RU',{hour:'2-digit',minute:'2-digit'});}catch(e){console.error(\"Invalid date string:\",dateTimeString,e);return'Неверная дата';}};return/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 space-y-6 min-h-screen\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"flex justify-between items-center mb-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold\",style:{color:textColor},children:\"\\u041C\\u043E\\u0438 \\u0417\\u0430\\u043C\\u0435\\u0442\\u043A\\u0438\"}),/*#__PURE__*/_jsx(\"button\",{onClick:navigateToSettings,className:\"p-2 rounded-full transition-colors duration-200\",style:{backgroundColor:accentColor,color:'white'},children:/*#__PURE__*/_jsx(Settings,{size:20})})]}),notes.length===0&&/*#__PURE__*/_jsx(\"p\",{style:{color:hintColor},children:\"\\u0423 \\u0432\\u0430\\u0441 \\u043F\\u043E\\u043A\\u0430 \\u043D\\u0435\\u0442 \\u0441\\u043E\\u0445\\u0440\\u0430\\u043D\\u0435\\u043D\\u043D\\u044B\\u0445 \\u0437\\u0430\\u043C\\u0435\\u0442\\u043E\\u043A.\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:notes.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 rounded-xl cursor-pointer transition-all duration-200 hover:opacity-80\",style:{backgroundColor:hintColor+'08'},onClick:()=>navigateToEditor(item.id),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium text-lg\",style:{color:textColor},children:item.title}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs font-semibold\",style:{color:hintColor},children:formatDateTime(item.lastEdited)})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm line-clamp-2\",style:{color:hintColor},children:[item.content.split('\\n')[0].substring(0,150),\"...\"]})]},item.id))})]});};/**\r\n * Основной компонент Telegram Mini App\r\n */const App=()=>{var _window$Telegram3,_window$Telegram3$Web,_window$Telegram3$Web2,_tma$themeParams,_tma$themeParams2,_tma$themeParams3,_tma$themeParams4,_tma$themeParams5;const params=useUrlParams();// Инициализация Firebase и Аутентификация\nconst{isAuthReady,db,auth,userId}=useFirebaseInit();// Подписка на данные Firestore\nconst{items,isDataLoading}=useFirestore(isAuthReady,userId);const[isGeminiLoading,setIsGeminiLoading]=useState(false);const[currentPage,setCurrentPage]=useState('calendar');// Имитация смены акцентного цвета через TMA\nconst initialAccent=((_window$Telegram3=window.Telegram)===null||_window$Telegram3===void 0?void 0:(_window$Telegram3$Web=_window$Telegram3.WebApp)===null||_window$Telegram3$Web===void 0?void 0:(_window$Telegram3$Web2=_window$Telegram3$Web.themeParams)===null||_window$Telegram3$Web2===void 0?void 0:_window$Telegram3$Web2.button_color)||'#007aff';const[manualAccentColor,setManualAccentColor]=useState(initialAccent);// Создание новой пустой записи\nconst createNewItem=function(editId){let type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'Event';return{id:editId||'new_item',type:type,title:'',content:'',date:type==='Note'?'':new Date().toISOString().split('T')[0],time:type==='Note'?'':'09:00',hasReminder:type==='Reminder',reminderValue:15,reminderUnit:'minutes',lastEdited:new Date().toISOString()};};const[itemData,setItemData]=useState(createNewItem(params.edit_id));// Эффект для загрузки данных при переходе в режим редактирования\nuseEffect(()=>{const editId=params.edit_id;if(editId&&items.length>0){const item=items.find(i=>i.id===editId);if(item){setItemData(item);}else{// Если item не найден (удален или ошибка), сбрасываем на новую запись\nsetItemData(createNewItem('new_item'));}}else if(editId&&isDataLoading){// Ждем загрузки данных, ничего не делаем\n}else{// Если нет ID в параметрах, или данные загружены, но ID не был найден (сброс)\nsetItemData(createNewItem());}},[params.edit_id,items,isDataLoading]);// Логика кнопки \"Сохранить/Добавить\"\nconst isFormValid=itemData.title.trim().length>0;const mainButtonText=useMemo(()=>{const isNewItem=itemData.id==='new_item';if(isNewItem){return itemData.type==='Note'?'СОХРАНИТЬ':'ДОБАВИТЬ';}else{return'СОХРАНИТЬ';}},[itemData.id,itemData.type]);// --- ФУНКЦИЯ СОХРАНЕНИЯ В FIRESTORE ---\nconst handleMainButtonClick=useMemo(()=>()=>{if(!isFormValid||!db||!userId){tma===null||tma===void 0?void 0:tma.showAlert('Ошибка: Пожалуйста, введите заголовок или дождитесь подключения к базе данных.',()=>tma===null||tma===void 0?void 0:tma.MainButton.enable());return;}const isNew=itemData.id==='new_item';// Данные, готовые к сохранению (исключаем внутренний id)\nconst _itemData$lastEdited=_objectSpread(_objectSpread({},itemData),{},{lastEdited:new Date().toISOString()// Всегда обновляем дату редактирования\n}),{id}=_itemData$lastEdited,dataToSave=_objectWithoutProperties(_itemData$lastEdited,_excluded);const collectionPath=\"artifacts/\".concat(appId,\"/users/\").concat(userId,\"/planner_items\");const itemsCollectionRef=collection(db,collectionPath);const saveOperation=isNew?addDoc(itemsCollectionRef,dataToSave)// Добавить новый документ\n:setDoc(doc(db,collectionPath,itemData.id),dataToSave);// Обновить существующий (по id)\nsaveOperation.then(()=>{tma===null||tma===void 0?void 0:tma.showAlert(\"\\u0417\\u0430\\u043F\\u0438\\u0441\\u044C \\u0443\\u0441\\u043F\\u0435\\u0448\\u043D\\u043E \".concat(isNew?'создана':'обновлена',\"!\"),()=>{// Возвращаемся на соответствующую вкладку\nsetCurrentPage(itemData.type==='Note'?'notes':'calendar');setItemData(createNewItem());// Сброс редактора для новой записи\n});}).catch(error=>{console.error(\"Ошибка сохранения в Firestore:\",error);tma===null||tma===void 0?void 0:tma.showAlert(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0441\\u043E\\u0445\\u0440\\u0430\\u043D\\u0435\\u043D\\u0438\\u044F: \".concat(error.message));});},[itemData,isFormValid,db,userId]);const{isTmaReady,tma}=useTma(mainButtonText,currentPage==='editor',isFormValid&&!isGeminiLoading,handleMainButtonClick);// --- ФУНКЦИЯ УДАЛЕНИЯ ИЗ FIRESTORE ---\nconst handleDelete=useCallback(()=>{if(!db||!userId||!itemData.id||itemData.id==='new_item')return;if(tma){tma.showConfirm('Вы уверены, что хотите удалить эту запись? Это действие необратимо.',isConfirmed=>{if(isConfirmed){const docRef=doc(db,\"artifacts/\".concat(appId,\"/users/\").concat(userId,\"/planner_items\"),itemData.id);deleteDoc(docRef).then(()=>{tma.showAlert('Запись удалена.',()=>{setCurrentPage(itemData.type==='Note'?'notes':'calendar');setItemData(createNewItem());});}).catch(error=>{console.error(\"Ошибка удаления из Firestore:\",error);tma.showAlert(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0443\\u0434\\u0430\\u043B\\u0435\\u043D\\u0438\\u044F: \".concat(error.message));});}});}},[db,userId,itemData.id,itemData.type,tma]);const navigateToEditor=function(){let id=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'new_item';let type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'Event';if(id==='new_item'){setItemData(createNewItem('new_item',type));}else{const item=items.find(i=>i.id===id);if(item)setItemData(item);}setCurrentPage('editor');};const navigateToSettings=useCallback(()=>{setCurrentPage('settings');},[]);// Обновление акцентного цвета в TMA\nuseEffect(()=>{if(tma){tma.MainButton.setParams({color:manualAccentColor});}},[manualAccentColor,tma]);if(!isTmaReady||!isAuthReady||isDataLoading){// Показываем общий экран загрузки, пока Firebase и данные не готовы\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center min-h-screen\",style:{backgroundColor:'#1c1c1e',color:'#ffffff'},children:[/*#__PURE__*/_jsx(Loader,{size:40,className:\"animate-spin mb-4\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-lg font-medium\",children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u043F\\u043B\\u0430\\u043D\\u0438\\u0440\\u043E\\u0432\\u0449\\u0438\\u043A\\u0430 \\u0438 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445...\"})]});}// Определяем основной цвет фона и текста Telegram\nconst backgroundColor=(tma===null||tma===void 0?void 0:(_tma$themeParams=tma.themeParams)===null||_tma$themeParams===void 0?void 0:_tma$themeParams.bg_color)||'#1c1c1e';const textColor=(tma===null||tma===void 0?void 0:(_tma$themeParams2=tma.themeParams)===null||_tma$themeParams2===void 0?void 0:_tma$themeParams2.text_color)||'#ffffff';const accentColor=manualAccentColor;const hintColor=(tma===null||tma===void 0?void 0:(_tma$themeParams3=tma.themeParams)===null||_tma$themeParams3===void 0?void 0:_tma$themeParams3.hint_color)||'#8e8e93';const destructiveColor=(tma===null||tma===void 0?void 0:(_tma$themeParams4=tma.themeParams)===null||_tma$themeParams4===void 0?void 0:_tma$themeParams4.destructive_text_color)||'#ff3b30';// --- Навигационная панель ---\nconst NavButton=_ref7=>{let{page,icon:Icon,label}=_ref7;return/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setCurrentPage(page),className:\"flex-1 flex flex-col items-center p-2 text-xs font-medium transition-colors duration-200 \\n            \".concat(currentPage===page?'opacity-100':'opacity-60',\"\\n          \"),style:{color:currentPage===page?accentColor:textColor},children:[/*#__PURE__*/_jsx(Icon,{size:24,className:\"mb-0.5\"}),label]});};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen\",style:{backgroundColor,color:textColor,fontFamily:'Inter, sans-serif'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"pb-20\",children:[currentPage==='editor'&&/*#__PURE__*/_jsx(EditorView,{itemData:itemData,setItemData:setItemData,handleDelete:handleDelete,tma:tma,backgroundColor:backgroundColor,textColor:textColor,accentColor:accentColor,hintColor:hintColor,destructiveColor:destructiveColor,simulateAIChat:simulateAIChat,navigateToSettings:navigateToSettings}),currentPage==='calendar'&&/*#__PURE__*/_jsx(CalendarView,{tma:tma,items:items,textColor:textColor,backgroundColor:backgroundColor,accentColor:accentColor,hintColor:hintColor,navigateToEditor:navigateToEditor,navigateToSettings:navigateToSettings}),currentPage==='notes'&&/*#__PURE__*/_jsx(NotesView,{tma:tma,items:items,textColor:textColor,backgroundColor:backgroundColor,accentColor:accentColor,hintColor:hintColor,navigateToEditor:navigateToEditor,navigateToSettings:navigateToSettings}),currentPage==='settings'&&/*#__PURE__*/_jsx(SettingsView,{tma:tma,textColor:textColor,backgroundColor:backgroundColor,accentColor:accentColor,hintColor:hintColor,setCurrentPage:setCurrentPage,setAccentColor:setManualAccentColor})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"fixed bottom-0 left-0 right-0 h-16 flex justify-around items-center border-t backdrop-blur-sm\",style:{backgroundColor:(tma===null||tma===void 0?void 0:(_tma$themeParams5=tma.themeParams)===null||_tma$themeParams5===void 0?void 0:_tma$themeParams5.secondary_bg_color)||'#2c2c2e',borderColor:hintColor+'33'},children:[/*#__PURE__*/_jsx(NavButton,{page:\"calendar\",icon:Calendar,label:\"\\u041A\\u0430\\u043B\\u0435\\u043D\\u0434\\u0430\\u0440\\u044C\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{navigateToEditor('new_item');},className:\"p-4 rounded-full absolute -top-4 shadow-2xl transition-transform duration-200 hover:scale-105\",style:{backgroundColor:accentColor,color:backgroundColor,boxShadow:\"0 0 20px \".concat(accentColor,\"88\")},title:\"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C \\u043D\\u043E\\u0432\\u0443\\u044E \\u0437\\u0430\\u043F\\u0438\\u0441\\u044C\",children:/*#__PURE__*/_jsx(Zap,{size:24})}),/*#__PURE__*/_jsx(NavButton,{page:\"notes\",icon:NotebookText,label:\"\\u0417\\u0430\\u043C\\u0435\\u0442\\u043A\\u0438\"})]})]});};export default App;","map":{"version":3,"names":["React","useState","useEffect","useMemo","useCallback","useRef","Settings","Clock","Calendar","CheckCircle","Trash2","Home","List","ChevronDown","Loader","Zap","Bold","Italic","ListChecks","Palette","NotebookText","Users","MessageSquare","initializeApp","getAuth","signInAnonymously","signInWithCustomToken","onAuthStateChanged","setPersistence","browserLocalPersistence","getFirestore","doc","getDoc","addDoc","setDoc","updateDoc","deleteDoc","onSnapshot","collection","query","where","orderBy","getDocs","jsx","_jsx","jsxs","_jsxs","REMINDER_OPTIONS","label","value","unit","GeminiIcon","_ref","size","className","width","height","viewBox","fill","xmlns","children","d","appId","__app_id","firebaseConfig","__firebase_config","JSON","parse","initialAuthToken","__initial_auth_token","app","db","auth","useFirebaseInit","isAuthReady","setIsAuthReady","userId","setUserId","authenticateUser","unsubscribe","user","uid","crypto","randomUUID","error","console","useFirestore","items","setItems","isDataLoading","setIsDataLoading","collectionPath","concat","itemsCollectionRef","snapshot","fetchedItems","docs","map","_objectSpread","id","data","sortedItems","sort","a","b","dateA","lastEdited","Date","getTime","dateB","generateUniqueId","now","Math","random","toString","substring","useUrlParams","params","setParams","searchParams","URLSearchParams","window","location","search","newParams","key","entries","useTma","mainButtonText","isMainButtonVisible","isMainButtonActive","onMainButtonClick","_window$Telegram","isTmaReady","setIsTmaReady","tma","Telegram","WebApp","ready","isExpanded","expand","MainButton","setText","color","themeParams","button_color","show","hide","enable","disable","onEvent","offEvent","warn","simulateAIChat","item","title","showAlert","SettingsView","_ref2","_window$Telegram2","_window$Telegram2$Web","_window$Telegram2$Web2","textColor","backgroundColor","hintColor","setCurrentPage","setAccentColor","setHeaderColor","geminiBlue","currentAccentColor","onClick","style","borderColor","EditorView","_ref3","itemData","setItemData","handleDelete","accentColor","destructiveColor","navigateToSettings","contentRef","handleChange","e","name","type","checked","target","prev","current","scrollHeight","content","handleTypeChange","newType","newData","time","date","hasReminder","reminderValue","reminderUnit","toISOString","split","undefined","handleReminderChange","parseInt","insertMarkdown","syntax","currentContent","newContent","TypeButton","_ref4","icon","Icon","border","needsDateTimeSection","showReminderCheckbox","isNoteType","isExistingItem","selectStyle","padding","borderRadius","appearance","cursor","backgroundImage","slice","backgroundRepeat","backgroundPosition","backgroundSize","handleShare","htmlFor","onChange","placeholder","ref","rows","toLocaleString","opt","CalendarView","_ref5","navigateToEditor","scheduledItems","filter","groupedItems","reduce","acc","push","sortedDates","Object","keys","getIcon","length","toLocaleDateString","weekday","year","month","day","localeCompare","NotesView","_ref6","notes","formatDateTime","dateTimeString","toLocaleTimeString","hour","minute","App","_window$Telegram3","_window$Telegram3$Web","_window$Telegram3$Web2","_tma$themeParams","_tma$themeParams2","_tma$themeParams3","_tma$themeParams4","_tma$themeParams5","isGeminiLoading","setIsGeminiLoading","currentPage","initialAccent","manualAccentColor","setManualAccentColor","createNewItem","editId","arguments","edit_id","find","i","isFormValid","trim","isNewItem","handleMainButtonClick","isNew","_itemData$lastEdited","dataToSave","_objectWithoutProperties","_excluded","saveOperation","then","catch","message","showConfirm","isConfirmed","docRef","bg_color","text_color","hint_color","destructive_text_color","NavButton","_ref7","page","fontFamily","secondary_bg_color","boxShadow"],"sources":["D:/Тимофей/Работа/Go/Calendar/front_react/src/App.jsx"],"sourcesContent":["import React, { useState, useEffect, useMemo, useCallback, useRef } from 'react';\r\nimport { Settings, Clock, Calendar, CheckCircle, Trash2, Home, List, ChevronDown, Loader, Zap, Bold, Italic, ListChecks, Palette, NotebookText, Users, MessageSquare } from 'lucide-react';\r\n\r\n// --- FIREBASE IMPORTS ---\r\nimport { initializeApp } from 'firebase/app';\r\nimport { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged, setPersistence, browserLocalPersistence } from 'firebase/auth';\r\nimport { getFirestore, doc, getDoc, addDoc, setDoc, updateDoc, deleteDoc, onSnapshot, collection, query, where, orderBy, getDocs } from 'firebase/firestore';\r\n\r\n// --- CONSTANTS ---\r\nconst REMINDER_OPTIONS = [\r\n    { label: '5 минут', value: 5, unit: 'minutes' },\r\n    { label: '15 минут', value: 15, unit: 'minutes' },\r\n    { label: '30 минут', value: 30, unit: 'minutes' },\r\n    { label: '1 час', value: 1, unit: 'hour' },\r\n    { label: '2 часа', value: 2, unit: 'hour' },\r\n    { label: '1 день', value: 1, unit: 'day' },\r\n    { label: '2 дня', value: 2, unit: 'day' },\r\n];\r\nconst GeminiIcon = ({ size = 20, className = \"\" }) => (\r\n    <svg className={className} width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n        <path d=\"M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm1.6 15.6H10.4v-4.8H8.8V11.2h1.6V7.6h3.2v3.6h1.6v2.4h-1.6v4.8z\" fill=\"currentColor\"/>\r\n    </svg>\r\n);\r\n\r\n\r\n// --- FIREBASE SETUP AND HOOKS ---\r\n\r\n// Глобальные переменные среды (обязательно для Canvas)\r\nconst appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';\r\nconst firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};\r\nconst initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;\r\n\r\nlet app, db, auth;\r\n\r\n// Хук для инициализации Firebase и аутентификации\r\nconst useFirebaseInit = () => {\r\n    const [isAuthReady, setIsAuthReady] = useState(false);\r\n    const [userId, setUserId] = useState(null);\r\n\r\n    useEffect(() => {\r\n        try {\r\n            // 1. Инициализация Firebase\r\n            app = initializeApp(firebaseConfig);\r\n            db = getFirestore(app);\r\n            auth = getAuth(app);\r\n            \r\n            // Устанавливаем постоянное хранение, чтобы избежать повторной анонимной аутентификации\r\n            setPersistence(auth, browserLocalPersistence);\r\n\r\n            // 2. Обработка Аутентификации\r\n            const authenticateUser = async () => {\r\n                if (initialAuthToken) {\r\n                    await signInWithCustomToken(auth, initialAuthToken);\r\n                } else {\r\n                    await signInAnonymously(auth);\r\n                }\r\n            };\r\n            \r\n            // 3. Установка слушателя изменений состояния аутентификации\r\n            const unsubscribe = onAuthStateChanged(auth, (user) => {\r\n                if (user) {\r\n                    setUserId(user.uid);\r\n                } else {\r\n                    // Если user null, это означает, что аутентификация еще не произошла\r\n                    // или пользователь вышел. В нашем случае, мы обеспечиваем вход выше.\r\n                    setUserId(crypto.randomUUID()); // Использование временного ID для анонимных\r\n                }\r\n                setIsAuthReady(true);\r\n            });\r\n\r\n            authenticateUser();\r\n            return () => unsubscribe();\r\n\r\n        } catch (error) {\r\n            console.error(\"Ошибка инициализации Firebase или Аутентификации:\", error);\r\n            setIsAuthReady(true); // Разрешаем UI продолжить, но без данных\r\n        }\r\n    }, []);\r\n\r\n    return { isAuthReady, db, auth, userId };\r\n};\r\n\r\n// Хук для получения данных из Firestore в реальном времени\r\nconst useFirestore = (isAuthReady, userId) => {\r\n    const [items, setItems] = useState([]);\r\n    const [isDataLoading, setIsDataLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        if (!isAuthReady || !db || !userId) {\r\n            // Ждем, пока аутентификация не будет готова и userId не будет установлен\r\n            return;\r\n        }\r\n\r\n        // Путь к коллекции: artifacts/{appId}/users/{userId}/planner_items\r\n        const collectionPath = `artifacts/${appId}/users/${userId}/planner_items`;\r\n        const itemsCollectionRef = collection(db, collectionPath);\r\n        \r\n        // Получаем все записи и сортируем их локально\r\n        const unsubscribe = onSnapshot(itemsCollectionRef, (snapshot) => {\r\n            const fetchedItems = snapshot.docs.map(doc => ({\r\n                id: doc.id,\r\n                ...doc.data()\r\n            }));\r\n            \r\n            // Сортировка по lastEdited (самые новые заметки сверху)\r\n            const sortedItems = fetchedItems.sort((a, b) => {\r\n                const dateA = a.lastEdited ? new Date(a.lastEdited).getTime() : 0;\r\n                const dateB = b.lastEdited ? new Date(b.lastEdited).getTime() : 0;\r\n                return dateB - dateA; // Сортировка по убыванию\r\n            });\r\n\r\n            setItems(sortedItems);\r\n            setIsDataLoading(false);\r\n            \r\n        }, (error) => {\r\n            console.error(\"Ошибка подписки Firestore:\", error);\r\n            setIsDataLoading(false);\r\n        });\r\n\r\n        return () => unsubscribe();\r\n    }, [isAuthReady, userId]);\r\n\r\n    return { items, isDataLoading };\r\n};\r\n\r\n\r\n// --- Вспомогательные функции ---\r\n\r\nconst generateUniqueId = () => `item_${Date.now()}_${Math.random().toString(36).substring(2, 9)}`;\r\n\r\nconst useUrlParams = () => {\r\n  const [params, setParams] = useState({});\r\n  useEffect(() => {\r\n    const searchParams = new URLSearchParams(window.location.search);\r\n    const newParams = {};\r\n    for (const [key, value] of searchParams.entries()) {\r\n      newParams[key] = value;\r\n    }\r\n    setParams(newParams);\r\n  }, []);\r\n  return params;\r\n};\r\n\r\n// --- TMA HOOKS ---\r\nconst useTma = (mainButtonText, isMainButtonVisible, isMainButtonActive, onMainButtonClick) => {\r\n  const [isTmaReady, setIsTmaReady] = useState(false);\r\n  const tma = window.Telegram?.WebApp;\r\n\r\n  useEffect(() => {\r\n    if (tma) {\r\n      tma.ready();\r\n      setIsTmaReady(true);\r\n      if (!tma.isExpanded) { tma.expand(); }\r\n\r\n      tma.MainButton.setText(mainButtonText);\r\n      tma.MainButton.setParams({ color: tma.themeParams.button_color });\r\n\r\n      if (isMainButtonVisible) { tma.MainButton.show(); } else { tma.MainButton.hide(); }\r\n      if (isMainButtonActive) { tma.MainButton.enable(); } else { tma.MainButton.disable(); }\r\n\r\n      tma.onEvent('mainButtonClicked', onMainButtonClick);\r\n      \r\n      return () => { tma.offEvent('mainButtonClicked', onMainButtonClick); };\r\n    } else {\r\n      console.warn(\"Telegram WebApp SDK не найден. Запуск в режиме разработки.\");\r\n      setIsTmaReady(true);\r\n    }\r\n  }, [tma, mainButtonText, isMainButtonVisible, isMainButtonActive, onMainButtonClick]);\r\n\r\n  return { isTmaReady, tma };\r\n};\r\n\r\n// --- API Gemini (симуляция) ---\r\nconst simulateAIChat = (tma, item) => {\r\n    const title = item.title || \"Новая заметка\";\r\n    tma?.showAlert(`Симуляция: Запущен чат с Gemini.\\n\\nТема: \"${title}\".\\n\\nЗдесь можно попросить ИИ помочь с контентом для заметки, а затем вставить результат в редактор.`, () => {});\r\n};\r\n\r\n\r\n// --- Компонент \"Настройки\" ---\r\nconst SettingsView = ({ tma, textColor, backgroundColor, hintColor, setCurrentPage, setAccentColor }) => {\r\n    \r\n    if (tma) tma.setHeaderColor('secondary_bg_color');\r\n    const geminiBlue = '#4285F4'; \r\n    \r\n    const currentAccentColor = window.Telegram?.WebApp?.themeParams?.button_color || '#007aff';\r\n\r\n\r\n    return (\r\n        <div className=\"p-4 space-y-6 min-h-screen\">\r\n            <header className=\"flex justify-between items-center mb-6\">\r\n                <h1 className=\"text-2xl font-bold\">Настройки</h1>\r\n                <button \r\n                    onClick={() => setCurrentPage('calendar')} \r\n                    className=\"p-2 rounded-full transition-colors duration-200\" \r\n                    style={{ backgroundColor: currentAccentColor, color: backgroundColor }}\r\n                >\r\n                    <Home size={20} />\r\n                </button>\r\n            </header>\r\n\r\n            {/* Секция Тема */}\r\n            <div className=\"p-4 rounded-2xl shadow-xl space-y-3\" style={{ backgroundColor: hintColor + '08' }}>\r\n                <div className=\"flex items-center space-x-2\" style={{ color: textColor }}>\r\n                    <Palette size={20} />\r\n                    <h2 className=\"text-lg font-medium\">Тема и Цвета</h2>\r\n                </div>\r\n                \r\n                <p className=\"text-sm\" style={{ color: hintColor }}>\r\n                    Приложение использует цвета вашей темы Telegram (TMA) для минимализма.\r\n                </p>\r\n\r\n                <div className=\"pt-3\">\r\n                    <label className=\"text-sm uppercase tracking-wider block mb-2\" style={{ color: hintColor }}>Выбрать Акцент</label>\r\n                    <div className=\"flex space-x-3\">\r\n                        {['#007aff', '#34c759', '#ff9500', '#eb5757', geminiBlue].map(color => (\r\n                            <button\r\n                                key={color}\r\n                                onClick={() => setAccentColor(color)}\r\n                                className=\"w-10 h-10 rounded-full border-2 transition-transform duration-100 transform hover:scale-110\"\r\n                                style={{ \r\n                                    backgroundColor: color, \r\n                                    borderColor: currentAccentColor === color ? textColor : 'transparent' \r\n                                }}\r\n                                title={color}\r\n                            />\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            \r\n        </div>\r\n    );\r\n};\r\n\r\n\r\n// --- Компонент \"Редактор\" ---\r\nconst EditorView = ({ \r\n    itemData, \r\n    setItemData, \r\n    handleDelete, \r\n    tma, \r\n    backgroundColor, \r\n    textColor, \r\n    accentColor, \r\n    hintColor, \r\n    destructiveColor,\r\n    simulateAIChat,\r\n    navigateToSettings\r\n}) => {\r\n    \r\n    const contentRef = useRef(null); \r\n    const geminiBlue = '#4285F4';\r\n    \r\n    if (tma) tma.setHeaderColor('secondary_bg_color');\r\n\r\n    const handleChange = (e) => {\r\n        const { name, value, type, checked } = e.target;\r\n        setItemData(prev => ({\r\n            ...prev,\r\n            [name]: type === 'checkbox' ? checked : value,\r\n        }));\r\n    };\r\n\r\n    // Хук для авто-изменения размера textarea\r\n    useEffect(() => {\r\n        if (contentRef.current) {\r\n            contentRef.current.style.height = 'auto'; \r\n            contentRef.current.style.height = `${contentRef.current.scrollHeight}px`;\r\n        }\r\n    }, [itemData.content, itemData.type]); \r\n\r\n    \r\n    const handleTypeChange = (newType) => {\r\n        setItemData(prev => {\r\n            let newData = { ...prev, type: newType };\r\n            \r\n            // Логика по управлению датой/временем при смене типа\r\n            if (newType === 'Note') {\r\n                newData.time = '';\r\n                newData.date = ''; \r\n                newData.hasReminder = false;\r\n                newData.reminderValue = 15;\r\n                newData.reminderUnit = 'minutes';\r\n            } \r\n            else if (newType === 'Reminder' || newType === 'Event') {\r\n                newData.time = prev.time || '09:00';\r\n                newData.date = prev.date || new Date().toISOString().split('T')[0];\r\n                newData.hasReminder = prev.hasReminder !== undefined ? prev.hasReminder : (newType === 'Reminder'); \r\n            } \r\n            \r\n            return newData;\r\n        });\r\n    };\r\n    \r\n    const handleReminderChange = (e) => {\r\n        const [value, unit] = e.target.value.split('_');\r\n        setItemData(prev => ({\r\n            ...prev,\r\n            reminderValue: parseInt(value, 10),\r\n            reminderUnit: unit,\r\n        }));\r\n    };\r\n    \r\n    // Функция для вставки Markdown синтаксиса (симуляция)\r\n    const insertMarkdown = (syntax) => {\r\n        setItemData(prev => {\r\n            const currentContent = prev.content || '';\r\n            const newContent = currentContent + syntax;\r\n            return {\r\n                ...prev,\r\n                content: newContent,\r\n            };\r\n        });\r\n    };\r\n\r\n\r\n    const TypeButton = ({ type, icon: Icon, label }) => (\r\n        <button\r\n          onClick={() => handleTypeChange(type)}\r\n          className={`flex items-center justify-center p-3 rounded-xl transition-all duration-200 w-1/3 text-sm font-semibold \r\n            ${itemData.type === type \r\n              ? 'bg-opacity-90' : 'bg-opacity-10 backdrop-blur-sm hover:bg-opacity-20'}\r\n          `}\r\n          style={{\r\n            backgroundColor: itemData.type === type ? accentColor : 'transparent',\r\n            color: itemData.type === type ? backgroundColor : textColor,\r\n            border: itemData.type !== type ? `1px solid ${hintColor}33` : 'none', \r\n          }}\r\n        >\r\n          <Icon size={20} className=\"mr-2\" />\r\n          {label}\r\n        </button>\r\n    );\r\n    \r\n    const needsDateTimeSection = itemData.type === 'Event' || itemData.type === 'Reminder';\r\n    const showReminderCheckbox = itemData.type === 'Event';\r\n    const isNoteType = itemData.type === 'Note';\r\n    const isExistingItem = itemData.id && itemData.id !== 'new_item';\r\n\r\n\r\n    // Стилизация выпадающего списка\r\n    const selectStyle = {\r\n        backgroundColor: hintColor + '15', \r\n        color: textColor,\r\n        border: 'none',\r\n        padding: '12px',\r\n        borderRadius: '12px',\r\n        appearance: 'none',\r\n        cursor: 'pointer',\r\n        backgroundImage: `url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='%23${textColor.slice(1)}'%3E%3Cpath d='M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z' clip-rule='evenodd' fill-rule='evenodd'%3E%3C/path%3E%3C/svg%3E\")`,\r\n        backgroundRepeat: 'no-repeat',\r\n        backgroundPosition: 'right 0.7rem center',\r\n        backgroundSize: '1.5em 1.5em',\r\n    };\r\n    \r\n    // Функция для симуляции открытия модала совместного доступа\r\n    const handleShare = () => {\r\n        tma?.showAlert('Симуляция: Открытие модала совместного доступа.\\n\\nЗдесь можно выбрать \"Ограниченный доступ\" или \"Доступ для редактирования\".');\r\n    }\r\n\r\n    return (\r\n        <div className=\"p-4 space-y-4\">\r\n            \r\n            <header className=\"flex justify-between items-center mb-6\">\r\n                <h1 className=\"text-2xl font-bold\">\r\n                    {itemData.id && itemData.id !== 'new_item' ? 'Редактировать' : 'Создать'} {isNoteType ? 'Заметку' : itemData.type === 'Event' ? 'Событие' : 'Напоминание'}\r\n                </h1>\r\n                <div className=\"flex space-x-3\">\r\n                    \r\n                    {/* Кнопка Настроек (возвращена в верхний правый угол) */}\r\n                    <button \r\n                        onClick={navigateToSettings}\r\n                        className=\"p-2 rounded-full transition-colors duration-200\" \r\n                        style={{ backgroundColor: accentColor, color: backgroundColor }}\r\n                    >\r\n                        <Settings size={20} />\r\n                    </button>\r\n                    \r\n                    {/* Кнопка Поделиться (только для существующих Заметок) */}\r\n                    {isNoteType && isExistingItem && (\r\n                        <button \r\n                            onClick={handleShare}\r\n                            className=\"p-2 rounded-full transition-colors duration-200\" \r\n                            style={{ backgroundColor: accentColor, color: backgroundColor }}\r\n                            title=\"Поделиться заметкой\"\r\n                        >\r\n                            <Users size={20} />\r\n                        </button>\r\n                    )}\r\n                    \r\n                    {/* Кнопка Удалить */}\r\n                    {isExistingItem && (\r\n                        <button \r\n                            onClick={handleDelete}\r\n                            className=\"p-2 rounded-full transition-colors duration-200\" \r\n                            style={{ backgroundColor: destructiveColor, color: backgroundColor }}\r\n                            title=\"Удалить запись\"\r\n                        >\r\n                          <Trash2 size={20} />\r\n                        </button>\r\n                    )}\r\n                </div>\r\n            </header>\r\n            \r\n            {/* Тип записи */}\r\n            <div className=\"p-4 rounded-2xl shadow-xl\" style={{ backgroundColor: hintColor + '08' }}>\r\n              <label className=\"text-xs uppercase tracking-wider block mb-2\" style={{ color: hintColor }}>Тип записи</label>\r\n              <div className=\"flex space-x-2\">\r\n                <TypeButton type=\"Event\" icon={Calendar} label=\"Событие\" />\r\n                <TypeButton type=\"Reminder\" icon={Clock} label=\"Напоминание\" />\r\n                <TypeButton type=\"Note\" icon={CheckCircle} label=\"Заметка\" />\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Поле Заголовок */}\r\n            <div className=\"p-4 rounded-2xl shadow-xl\" style={{ backgroundColor: hintColor + '08' }}>\r\n              <label className=\"text-xs uppercase tracking-wider block mb-2\" style={{ color: hintColor }} htmlFor=\"title\">Заголовок</label>\r\n              <input\r\n                id=\"title\"\r\n                name=\"title\"\r\n                type=\"text\"\r\n                value={itemData.title}\r\n                onChange={handleChange}\r\n                className=\"w-full text-lg bg-transparent border-none focus:outline-none placeholder-gray-500\"\r\n                style={{ color: textColor }}\r\n                placeholder=\"Краткое название\"\r\n              />\r\n            </div>\r\n\r\n            {/* Поле Описание */}\r\n            <div className=\"p-4 rounded-2xl shadow-xl\" style={{ backgroundColor: hintColor + '08' }}>\r\n              <label className=\"text-xs uppercase tracking-wider block mb-2\" style={{ color: hintColor }} htmlFor=\"content\">Описание / Контент</label>\r\n              \r\n              {/* Markdown Controls (для Заметок) */}\r\n              {isNoteType && (\r\n                  <div className=\"flex space-x-2 mb-2 p-1 rounded-lg\" style={{ backgroundColor: hintColor + '11' }}>\r\n                      <button \r\n                          onClick={() => insertMarkdown('**Жирный текст**')}\r\n                          className=\"p-2 rounded-lg hover:opacity-80 transition-opacity\"\r\n                          style={{ color: textColor }}\r\n                          title=\"Жирный шрифт\"\r\n                      >\r\n                          <Bold size={18} />\r\n                      </button>\r\n                      <button \r\n                          onClick={() => insertMarkdown('*Курсив*')}\r\n                          className=\"p-2 rounded-lg hover:opacity-80 transition-opacity\"\r\n                          style={{ color: textColor }}\r\n                          title=\"Курсив\"\r\n                      >\r\n                          <Italic size={18} />\r\n                      </button>\r\n                      <button \r\n                          onClick={() => insertMarkdown('\\n- [ ] Задача')}\r\n                          className=\"p-2 rounded-lg hover:opacity-80 transition-opacity\"\r\n                          style={{ color: textColor }}\r\n                          title=\"Список задач\"\r\n                      >\r\n                          <ListChecks size={18} />\r\n                      </button>\r\n                  </div>\r\n              )}\r\n              \r\n              <textarea\r\n                ref={contentRef}\r\n                id=\"content\"\r\n                name=\"content\"\r\n                value={itemData.content}\r\n                onChange={handleChange}\r\n                rows=\"1\" \r\n                className=\"w-full text-base bg-transparent border-none focus:outline-none placeholder-gray-500 resize-none overflow-hidden\"\r\n                style={{ color: textColor }}\r\n                placeholder=\"Подробности, место, участники...\"\r\n              />\r\n            </div>\r\n\r\n            \r\n            {/* КНОТКА AI CHAT (ТОЛЬКО для Заметок) */}\r\n            {isNoteType && (\r\n                <button\r\n                    onClick={() => simulateAIChat(tma, itemData)}\r\n                    className=\"w-full flex items-center justify-center p-3 rounded-xl text-sm font-bold transition-opacity duration-200 hover:opacity-90\"\r\n                    style={{ backgroundColor: geminiBlue, color: 'white' }}\r\n                >\r\n                    <MessageSquare size={20} className=\"mr-2\" style={{ color: 'white' }}/>\r\n                    Открыть чат с Gemini\r\n                </button>\r\n            )}\r\n\r\n            \r\n            {/* Дата и Время (ТОЛЬКО для Event/Reminder) */}\r\n            {needsDateTimeSection && (\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                <div className=\"p-4 rounded-2xl shadow-xl\" style={{ backgroundColor: hintColor + '08' }}>\r\n                  <label className=\"text-xs uppercase tracking-wider block mb-2\" style={{ color: hintColor }} htmlFor=\"date\">Дата</label>\r\n                  <input\r\n                    id=\"date\"\r\n                    name=\"date\"\r\n                    type=\"date\"\r\n                    value={itemData.date}\r\n                    onChange={handleChange}\r\n                    className=\"w-full text-lg bg-transparent border-none focus:outline-none\"\r\n                    style={{ color: textColor }}\r\n                  />\r\n                </div>\r\n                \r\n                <div className=\"p-4 rounded-2xl shadow-xl\" style={{ backgroundColor: hintColor + '08' }}>\r\n                    <label className=\"text-xs uppercase tracking-wider block mb-2\" style={{ color: hintColor }} htmlFor=\"time\">Время</label>\r\n                    <input\r\n                        id=\"time\"\r\n                        name=\"time\"\r\n                        type=\"time\"\r\n                        value={itemData.time}\r\n                        onChange={handleChange}\r\n                        className=\"w-full text-lg bg-transparent border-none focus:outline-none\"\r\n                        style={{ color: textColor }}\r\n                    />\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n\r\n            {/* Дата редактирования (ТОЛЬКО для Заметок) */}\r\n            {isNoteType && isExistingItem && (\r\n                 <div className=\"p-4 rounded-2xl shadow-xl\" style={{ backgroundColor: hintColor + '08' }}>\r\n                    <label className=\"text-xs uppercase tracking-wider block mb-2\" style={{ color: hintColor }}>Дата последнего редактирования</label>\r\n                    <p className=\"text-base\" style={{ color: textColor }}>\r\n                        {new Date(itemData.lastEdited).toLocaleString('ru-RU')}\r\n                    </p>\r\n                </div>\r\n            )}\r\n\r\n            {/* Секция Напоминания (ТОЛЬКО для Event/Reminder) */}\r\n            {needsDateTimeSection && (\r\n                <div className=\"p-4 rounded-2xl shadow-xl space-y-4\" style={{ backgroundColor: hintColor + '08' }}>\r\n                    \r\n                    {showReminderCheckbox ? (\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <label className=\"text-lg\" style={{ color: textColor }}>Напомнить</label>\r\n                            <div \r\n                                className={`h-6 w-6 rounded-lg flex items-center justify-center transition-all duration-200 cursor-pointer`}\r\n                                style={{ \r\n                                    backgroundColor: itemData.hasReminder ? accentColor : hintColor + '33',\r\n                                    border: itemData.hasReminder ? 'none' : `1px solid ${hintColor}`,\r\n                                }}\r\n                                onClick={() => setItemData(prev => ({ ...prev, hasReminder: !prev.hasReminder }))}\r\n                            >\r\n                                {itemData.hasReminder && <CheckCircle size={16} style={{ color: backgroundColor }} />}\r\n                            </div>\r\n                        </div>\r\n                    ) : (\r\n                        <h3 className=\"text-lg font-medium\" style={{ color: textColor }}>Настройки Напоминания</h3>\r\n                    )}\r\n                    \r\n                    {(itemData.hasReminder || itemData.type === 'Reminder') && (\r\n                        <div>\r\n                            <label className=\"text-xs uppercase tracking-wider block mb-2\" style={{ color: hintColor }} htmlFor=\"reminderSelect\">Напомнить за...</label>\r\n                            <select\r\n                                id=\"reminderSelect\"\r\n                                value={`${itemData.reminderValue}_${itemData.reminderUnit}`}\r\n                                onChange={handleReminderChange}\r\n                                style={selectStyle} \r\n                            >\r\n                                {REMINDER_OPTIONS.map(opt => (\r\n                                    <option key={`${opt.value}_${opt.unit}`} value={`${opt.value}_${opt.unit}`} style={{ backgroundColor: backgroundColor, color: textColor }}>\r\n                                        {opt.label}\r\n                                    </option>\r\n                                ))}\r\n                            </select>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            )}\r\n            \r\n            \r\n            <div className=\"h-20\">\r\n                {/* Пустое место для кнопки Telegram MainButton */}\r\n            </div>\r\n\r\n        </div>\r\n    );\r\n};\r\n\r\n\r\n// --- Компонент \"Календарь\" ---\r\nconst CalendarView = ({ tma, items, textColor, accentColor, hintColor, navigateToEditor, navigateToSettings }) => {\r\n    \r\n    if (tma) tma.setHeaderColor('secondary_bg_color');\r\n\r\n    // Фильтруем все, что не является Note, и группируем по дате\r\n    const scheduledItems = items.filter(item => item.type === 'Event' || item.type === 'Reminder');\r\n    const groupedItems = scheduledItems.reduce((acc, item) => {\r\n        const date = item.date;\r\n        if (!acc[date]) {\r\n            acc[date] = [];\r\n        }\r\n        acc[date].push(item);\r\n        return acc;\r\n    }, {});\r\n\r\n    const sortedDates = Object.keys(groupedItems).sort((a, b) => new Date(a) - new Date(b));\r\n\r\n    const getIcon = (type) => {\r\n        switch (type) {\r\n            case 'Event': return <Calendar size={18} style={{ color: accentColor }} />;\r\n            case 'Reminder': return <Clock size={18} style={{ color: accentColor }} />;\r\n            default: return null;\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"p-4 space-y-6 min-h-screen\">\r\n            <header className=\"flex justify-between items-center mb-6\">\r\n                <h2 className=\"text-2xl font-bold\" style={{ color: textColor }}>Календарь</h2>\r\n                <button \r\n                    onClick={navigateToSettings}\r\n                    className=\"p-2 rounded-full transition-colors duration-200\" \r\n                    style={{ backgroundColor: accentColor, color: 'white' }}\r\n                >\r\n                    <Settings size={20} />\r\n                </button>\r\n            </header>\r\n            \r\n            {sortedDates.length === 0 && (\r\n                <p style={{ color: hintColor }}>У вас пока нет запланированных событий или напоминаний.</p>\r\n            )}\r\n\r\n            {sortedDates.map(date => (\r\n                <div key={date}>\r\n                    <h3 className=\"text-sm uppercase font-semibold mb-2\" style={{ color: hintColor }}>\r\n                        {new Date(date).toLocaleDateString('ru-RU', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}\r\n                    </h3>\r\n                    <div className=\"space-y-2\">\r\n                        {groupedItems[date].sort((a, b) => (a.time || '00:00').localeCompare(b.time || '00:00')).map(item => (\r\n                            <div \r\n                                key={item.id}\r\n                                className=\"flex justify-between items-center p-3 rounded-xl cursor-pointer transition-all duration-200 hover:opacity-80\"\r\n                                style={{ backgroundColor: hintColor + '08' }}\r\n                                onClick={() => navigateToEditor(item.id)}\r\n                            >\r\n                                <div className=\"flex items-center space-x-3\">\r\n                                    {getIcon(item.type)}\r\n                                    <div>\r\n                                        <p className=\"font-medium\" style={{ color: textColor }}>{item.title}</p>\r\n                                        {(item.type === 'Event' || item.type === 'Reminder') && item.time && (\r\n                                            <p className=\"text-xs\" style={{ color: hintColor }}>{item.time}</p>\r\n                                        )}\r\n                                        {item.hasReminder && (\r\n                                             <p className=\"text-xs font-semibold\" style={{ color: accentColor }}>\r\n                                                Напомнить за {item.reminderValue} {item.reminderUnit === 'minutes' ? 'мин.' : item.reminderUnit === 'hour' ? 'ч.' : 'д.'}\r\n                                             </p>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n                                <ChevronDown size={16} style={{ color: hintColor }} className=\"rotate-[-90deg]\"/>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            ))}\r\n        </div>\r\n    );\r\n};\r\n\r\n// --- Компонент \"Мои Заметки\" ---\r\nconst NotesView = ({ items, textColor, accentColor, hintColor, navigateToEditor, tma, navigateToSettings }) => {\r\n    if (tma) tma.setHeaderColor('secondary_bg_color');\r\n\r\n    // Фильтруем и сортируем заметки по дате редактирования (сортировка уже сделана в useFirestore)\r\n    const notes = items.filter(item => item.type === 'Note');\r\n\r\n    const formatDateTime = (dateTimeString) => {\r\n        if (!dateTimeString) return 'Нет данных';\r\n        try {\r\n            const date = new Date(dateTimeString);\r\n            return date.toLocaleDateString('ru-RU') + ' ' + date.toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });\r\n        } catch (e) {\r\n            console.error(\"Invalid date string:\", dateTimeString, e);\r\n            return 'Неверная дата';\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"p-4 space-y-6 min-h-screen\">\r\n            <header className=\"flex justify-between items-center mb-6\">\r\n                <h2 className=\"text-2xl font-bold\" style={{ color: textColor }}>Мои Заметки</h2>\r\n                <button \r\n                    onClick={navigateToSettings}\r\n                    className=\"p-2 rounded-full transition-colors duration-200\" \r\n                    style={{ backgroundColor: accentColor, color: 'white' }}\r\n                >\r\n                    <Settings size={20} />\r\n                </button>\r\n            </header>\r\n            \r\n            {notes.length === 0 && (\r\n                <p style={{ color: hintColor }}>У вас пока нет сохраненных заметок.</p>\r\n            )}\r\n\r\n            <div className=\"space-y-3\">\r\n                {notes.map(item => (\r\n                    <div \r\n                        key={item.id}\r\n                        className=\"p-4 rounded-xl cursor-pointer transition-all duration-200 hover:opacity-80\"\r\n                        style={{ backgroundColor: hintColor + '08' }}\r\n                        onClick={() => navigateToEditor(item.id)}\r\n                    >\r\n                        <div className=\"flex justify-between items-center mb-1\">\r\n                            <p className=\"font-medium text-lg\" style={{ color: textColor }}>{item.title}</p>\r\n                            <span className=\"text-xs font-semibold\" style={{ color: hintColor }}>\r\n                                {formatDateTime(item.lastEdited)}\r\n                            </span>\r\n                        </div>\r\n                        <p className=\"text-sm line-clamp-2\" style={{ color: hintColor }}>\r\n                            {item.content.split('\\n')[0].substring(0, 150)}...\r\n                        </p>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\n\r\n/**\r\n * Основной компонент Telegram Mini App\r\n */\r\nconst App = () => {\r\n  const params = useUrlParams();\r\n  \r\n  // Инициализация Firebase и Аутентификация\r\n  const { isAuthReady, db, auth, userId } = useFirebaseInit();\r\n  // Подписка на данные Firestore\r\n  const { items, isDataLoading } = useFirestore(isAuthReady, userId);\r\n\r\n  const [isGeminiLoading, setIsGeminiLoading] = useState(false);\r\n  const [currentPage, setCurrentPage] = useState('calendar');\r\n  \r\n  // Имитация смены акцентного цвета через TMA\r\n  const initialAccent = window.Telegram?.WebApp?.themeParams?.button_color || '#007aff';\r\n  const [manualAccentColor, setManualAccentColor] = useState(initialAccent);\r\n\r\n  // Создание новой пустой записи\r\n  const createNewItem = (editId, type = 'Event') => {\r\n    return {\r\n        id: editId || 'new_item',\r\n        type: type, \r\n        title: '',\r\n        content: '',\r\n        date: type === 'Note' ? '' : new Date().toISOString().split('T')[0], \r\n        time: type === 'Note' ? '' : '09:00',\r\n        hasReminder: type === 'Reminder', \r\n        reminderValue: 15,\r\n        reminderUnit: 'minutes',\r\n        lastEdited: new Date().toISOString(), \r\n    }\r\n  };\r\n\r\n  const [itemData, setItemData] = useState(createNewItem(params.edit_id));\r\n  \r\n  // Эффект для загрузки данных при переходе в режим редактирования\r\n  useEffect(() => {\r\n    const editId = params.edit_id;\r\n    if (editId && items.length > 0) {\r\n        const item = items.find(i => i.id === editId);\r\n        if (item) {\r\n            setItemData(item);\r\n        } else {\r\n            // Если item не найден (удален или ошибка), сбрасываем на новую запись\r\n            setItemData(createNewItem('new_item'));\r\n        }\r\n    } else if (editId && isDataLoading) {\r\n         // Ждем загрузки данных, ничего не делаем\r\n    } else {\r\n        // Если нет ID в параметрах, или данные загружены, но ID не был найден (сброс)\r\n        setItemData(createNewItem());\r\n    }\r\n  }, [params.edit_id, items, isDataLoading]);\r\n  \r\n  // Логика кнопки \"Сохранить/Добавить\"\r\n  const isFormValid = itemData.title.trim().length > 0;\r\n  \r\n  const mainButtonText = useMemo(() => {\r\n    const isNewItem = itemData.id === 'new_item';\r\n    \r\n    if (isNewItem) { return itemData.type === 'Note' ? 'СОХРАНИТЬ' : 'ДОБАВИТЬ'; } \r\n    else { return 'СОХРАНИТЬ'; } \r\n  }, [itemData.id, itemData.type]);\r\n\r\n\r\n  // --- ФУНКЦИЯ СОХРАНЕНИЯ В FIRESTORE ---\r\n  const handleMainButtonClick = useMemo(() => () => {\r\n      if (!isFormValid || !db || !userId) {\r\n          tma?.showAlert('Ошибка: Пожалуйста, введите заголовок или дождитесь подключения к базе данных.', () => tma?.MainButton.enable());\r\n          return;\r\n      }\r\n      \r\n      const isNew = itemData.id === 'new_item';\r\n      \r\n      // Данные, готовые к сохранению (исключаем внутренний id)\r\n      const { id, ...dataToSave } = { \r\n          ...itemData, \r\n          lastEdited: new Date().toISOString(), // Всегда обновляем дату редактирования\r\n      };\r\n      \r\n      const collectionPath = `artifacts/${appId}/users/${userId}/planner_items`;\r\n      const itemsCollectionRef = collection(db, collectionPath);\r\n\r\n\r\n      const saveOperation = isNew\r\n          ? addDoc(itemsCollectionRef, dataToSave) // Добавить новый документ\r\n          : setDoc(doc(db, collectionPath, itemData.id), dataToSave); // Обновить существующий (по id)\r\n          \r\n      saveOperation\r\n        .then(() => {\r\n            tma?.showAlert(`Запись успешно ${isNew ? 'создана' : 'обновлена'}!`, () => {\r\n                // Возвращаемся на соответствующую вкладку\r\n                setCurrentPage(itemData.type === 'Note' ? 'notes' : 'calendar');\r\n                setItemData(createNewItem()); // Сброс редактора для новой записи\r\n            });\r\n        })\r\n        .catch((error) => {\r\n            console.error(\"Ошибка сохранения в Firestore:\", error);\r\n            tma?.showAlert(`Ошибка сохранения: ${error.message}`);\r\n        });\r\n      \r\n  }, [itemData, isFormValid, db, userId]);\r\n\r\n  const { isTmaReady, tma } = useTma(mainButtonText, currentPage === 'editor', isFormValid && !isGeminiLoading, handleMainButtonClick);\r\n\r\n  // --- ФУНКЦИЯ УДАЛЕНИЯ ИЗ FIRESTORE ---\r\n  const handleDelete = useCallback(() => {\r\n    if (!db || !userId || !itemData.id || itemData.id === 'new_item') return;\r\n\r\n    if (tma) {\r\n      tma.showConfirm('Вы уверены, что хотите удалить эту запись? Это действие необратимо.', (isConfirmed) => {\r\n        if (isConfirmed) {\r\n            const docRef = doc(db, `artifacts/${appId}/users/${userId}/planner_items`, itemData.id);\r\n            deleteDoc(docRef)\r\n                .then(() => {\r\n                    tma.showAlert('Запись удалена.', () => {\r\n                        setCurrentPage(itemData.type === 'Note' ? 'notes' : 'calendar');\r\n                        setItemData(createNewItem());\r\n                    });\r\n                })\r\n                .catch(error => {\r\n                    console.error(\"Ошибка удаления из Firestore:\", error);\r\n                    tma.showAlert(`Ошибка удаления: ${error.message}`);\r\n                });\r\n        }\r\n      });\r\n    }\r\n  }, [db, userId, itemData.id, itemData.type, tma]);\r\n  \r\n  const navigateToEditor = (id = 'new_item', type = 'Event') => {\r\n      if (id === 'new_item') {\r\n          setItemData(createNewItem('new_item', type));\r\n      } else {\r\n          const item = items.find(i => i.id === id);\r\n          if (item) setItemData(item);\r\n      }\r\n      setCurrentPage('editor');\r\n  }\r\n\r\n  const navigateToSettings = useCallback(() => {\r\n      setCurrentPage('settings');\r\n  }, []);\r\n  \r\n  // Обновление акцентного цвета в TMA\r\n  useEffect(() => {\r\n      if (tma) {\r\n          tma.MainButton.setParams({ color: manualAccentColor });\r\n      }\r\n  }, [manualAccentColor, tma]);\r\n\r\n\r\n  \r\n  if (!isTmaReady || !isAuthReady || isDataLoading) {\r\n    // Показываем общий экран загрузки, пока Firebase и данные не готовы\r\n    return (\r\n      <div className=\"flex flex-col items-center justify-center min-h-screen\" style={{ backgroundColor: '#1c1c1e', color: '#ffffff' }}>\r\n        <Loader size={40} className=\"animate-spin mb-4\" />\r\n        <div className=\"text-lg font-medium\">\r\n          Загрузка планировщика и данных...\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Определяем основной цвет фона и текста Telegram\r\n  const backgroundColor = tma?.themeParams?.bg_color || '#1c1c1e';\r\n  const textColor = tma?.themeParams?.text_color || '#ffffff';\r\n  const accentColor = manualAccentColor; \r\n  const hintColor = tma?.themeParams?.hint_color || '#8e8e93';\r\n  const destructiveColor = tma?.themeParams?.destructive_text_color || '#ff3b30';\r\n\r\n  // --- Навигационная панель ---\r\n  const NavButton = ({ page, icon: Icon, label }) => (\r\n      <button \r\n          onClick={() => setCurrentPage(page)}\r\n          className={`flex-1 flex flex-col items-center p-2 text-xs font-medium transition-colors duration-200 \r\n            ${currentPage === page ? 'opacity-100' : 'opacity-60'}\r\n          `}\r\n          style={{ color: currentPage === page ? accentColor : textColor }}\r\n      >\r\n          <Icon size={24} className=\"mb-0.5\" />\r\n          {label}\r\n      </button>\r\n  );\r\n\r\n  return (\r\n    <div \r\n      className=\"min-h-screen\" \r\n      style={{ backgroundColor, color: textColor, fontFamily: 'Inter, sans-serif' }}\r\n    >\r\n      \r\n      <div className=\"pb-20\"> \r\n          {currentPage === 'editor' && (\r\n              <EditorView \r\n                  itemData={itemData} \r\n                  setItemData={setItemData} \r\n                  handleDelete={handleDelete}\r\n                  tma={tma}\r\n                  backgroundColor={backgroundColor}\r\n                  textColor={textColor}\r\n                  accentColor={accentColor}\r\n                  hintColor={hintColor}\r\n                  destructiveColor={destructiveColor}\r\n                  simulateAIChat={simulateAIChat}\r\n                  navigateToSettings={navigateToSettings}\r\n              />\r\n          )}\r\n          \r\n          {currentPage === 'calendar' && (\r\n              <CalendarView \r\n                  tma={tma}\r\n                  items={items}\r\n                  textColor={textColor}\r\n                  backgroundColor={backgroundColor}\r\n                  accentColor={accentColor}\r\n                  hintColor={hintColor}\r\n                  navigateToEditor={navigateToEditor}\r\n                  navigateToSettings={navigateToSettings}\r\n              />\r\n          )}\r\n          \r\n          {currentPage === 'notes' && (\r\n              <NotesView \r\n                  tma={tma}\r\n                  items={items}\r\n                  textColor={textColor}\r\n                  backgroundColor={backgroundColor}\r\n                  accentColor={accentColor}\r\n                  hintColor={hintColor}\r\n                  navigateToEditor={navigateToEditor}\r\n                  navigateToSettings={navigateToSettings}\r\n              />\r\n          )}\r\n\r\n          {currentPage === 'settings' && (\r\n              <SettingsView\r\n                  tma={tma}\r\n                  textColor={textColor}\r\n                  backgroundColor={backgroundColor}\r\n                  accentColor={accentColor}\r\n                  hintColor={hintColor}\r\n                  setCurrentPage={setCurrentPage}\r\n                  setAccentColor={setManualAccentColor}\r\n              />\r\n          )}\r\n      </div>\r\n\r\n      {/* Фиксированная нижняя навигационная панель */}\r\n      <div \r\n          className=\"fixed bottom-0 left-0 right-0 h-16 flex justify-around items-center border-t backdrop-blur-sm\"\r\n          style={{ \r\n              backgroundColor: tma?.themeParams?.secondary_bg_color || '#2c2c2e', \r\n              borderColor: hintColor + '33',\r\n          }}\r\n      >\r\n          <NavButton page=\"calendar\" icon={Calendar} label=\"Календарь\" />\r\n          \r\n          {/* Плавающая кнопка для создания новой записи */}\r\n          <button \r\n              onClick={() => {\r\n                  navigateToEditor('new_item');\r\n              }}\r\n              className=\"p-4 rounded-full absolute -top-4 shadow-2xl transition-transform duration-200 hover:scale-105\"\r\n              style={{ \r\n                  backgroundColor: accentColor, \r\n                  color: backgroundColor,\r\n                  boxShadow: `0 0 20px ${accentColor}88` \r\n              }}\r\n              title=\"Создать новую запись\"\r\n          >\r\n              <Zap size={24} />\r\n          </button>\r\n          \r\n          <NavButton page=\"notes\" icon={NotebookText} label=\"Заметки\" />\r\n      </div>\r\n      \r\n    </div>\r\n  );\r\n};\r\n\r\nexport default App;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}